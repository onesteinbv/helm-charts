{{- if .Values.odooUpgrader.adminPasswordSecret.generate -}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "odoo-upgrader.fullname" . }}
data:
  {{- if .Release.IsInstall }}
  password: {{ randAlphaNum 128 | b64enc }}
  {{ else }}
  password: {{- $secret := (lookup "v1" "Secret" .Release.Namespace (include "odoo-upgrader.fullname" .)) -}}
  {{- if $secret -}}
    {{- $secret.data.password | b64dec | quote -}}
  {{- else -}}
    {{- randAlphaNum 128 | b64enc -}}
  {{- end -}}
  {{ end }}
{{- end }}
